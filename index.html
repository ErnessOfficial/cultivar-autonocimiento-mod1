<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cómo Cultivar tu Autoconocimiento para una Vida Plena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }
        .slide {
            display: none;
            opacity: 0;
            transition: opacity 0.6s ease-in-out;
            min-height: 400px;
            height: 100%;
        }
        .slide.active {
            display: block;
            opacity: 1;
        }
        #progress-bar-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background-color: #E5E7EB; /* gray-200 */
        }
        #progress-bar {
            height: 100%;
            background-color: #4F46E5; /* indigo-600 */
            width: 0%;
            transition: width 0.3s ease-in-out;
        }
        /* Custom scrollbar */
        .content-scroll::-webkit-scrollbar { width: 8px; }
        .content-scroll::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 10px; }
        .content-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .content-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Flip Card Styles */
        .card-flip {
            perspective: 1000px;
            cursor: pointer;
            min-height: 180px;
        }
        .card-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card-flip-inner.is-flipped {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            text-align: center;
        }
        .card-back {
            transform: rotateY(180deg);
            font-size: 0.9rem;
        }
        /* Quiz Styles */
        .quiz-option {
            transition: all 0.2s ease;
        }
        .quiz-option:hover {
            transform: scale(1.03);
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        .quiz-option.selected {
            border-color: #4F46E5;
            background-color: #EEF2FF;
        }
        .quiz-option.correct {
            border-color: #16A34A;
            background-color: #F0FDF4;
        }
        .quiz-option.incorrect {
            border-color: #DC2626;
            background-color: #FEF2F2;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex flex-col items-center justify-center min-h-screen p-4">

    <div id="presentation-container" class="w-full max-w-5xl bg-white rounded-2xl shadow-2xl overflow-hidden relative" style="height: 90vh;">
        <div class="p-8 md:p-12 h-full overflow-y-auto content-scroll">
            <!-- Slide 0: Selección de idioma / Language selection -->
            <div class="slide active">
                <div class="flex flex-col items-center justify-center h-full text-center space-y-6">
                    <h2 id="lang-heading" class="text-2xl md:text-3xl font-bold text-indigo-600">Idioma</h2>
                    <label id="lang-label" for="language-select" class="text-gray-700">Selecciona tu idioma</label>
                    <select id="language-select" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <option value="es">🇪🇸 Español</option>
                        <option value="en">🇬🇧 English</option>
                    </select>
                    <p id="lang-helper" class="text-sm text-gray-500">Usa el botón Siguiente para continuar</p>
                </div>
            </div>

            <!-- Slide 1: Título -->
            <div class="slide">
                <div class="flex flex-col items-center justify-center h-full text-center">
                    <h2 id="module-label" class="text-2xl font-semibold text-indigo-500 mb-4">Módulo 1</h2>
                    <div class="bg-indigo-600 text-white p-4 rounded-full w-24 h-24 flex items-center justify-center mb-8 shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 18a7 7 0 1 0-7-7c0 1.42.42 2.74 1.17 3.82l-2.06 2.06a1 1 0 0 0 1.41 1.41l2.06-2.06A6.95 6.95 0 0 0 11 18Z"/><path d="m2 2 1.17 1.17"/><path d="M22 22 20 20"/><path d="m2 22 2-2"/><path d="m22 2-2 2"/></svg>
                    </div>
                    <h1 id="main-title" class="text-3xl md:text-5xl font-bold text-gray-900 mb-4">Cómo Cultivar tu Autoconocimiento</h1>
                    <p id="main-subtitle" class="text-xl md:text-2xl text-gray-600">Para una Vida Plena</p>
                </div>
            </div>

            <!-- Slide 2: ¿Qué es el Autoconocimiento? -->
            <div class="slide">
                 <h2 id="s2-title" class="text-2xl md:text-3xl font-bold text-indigo-600 mb-8 text-center flex items-center justify-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
                    ¿Qué es el Autoconocimiento?
                </h2>
                 <div class="space-y-6 text-lg text-gray-700 bg-indigo-50 p-8 rounded-lg">
                     <p id="s2-p1">Es el conocimiento que tenemos de nosotros mismos, es decir, al conjunto de cosas que sabemos acerca de quiénes somos.</p>
                     <p id="s2-p2">Es un proceso de introspección que nos permite identificar nuestras <strong class="text-indigo-500">emociones, fortalezas, debilidades, valores y metas</strong>.</p>
                     <p id="s2-p3">Saber quién eres te da las herramientas para tomar mejores decisiones, gestionar tus emociones y construir relaciones más sanas.</p>
                 </div>
            </div>
            
            <!-- Slide 3: Fases del proceso (Flip Cards) -->
            <div class="slide">
                <h2 id="s3-title" class="text-2xl md:text-3xl font-bold text-indigo-600 mb-8 text-center flex items-center justify-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>
                    Fases del Proceso (Haz clic para girar)
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Cards will be dynamically inserted here by JS -->
                </div>
            </div>
            
            <!-- Slide 4: Quiz -->
            <div class="slide">
                 <h2 class="text-2xl md:text-3xl font-bold text-indigo-600 mb-8 text-center flex items-center justify-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20.5c-4.23.09-6.9-2.5-6.9-6.9.09-4.23 2.5-6.9 6.9-6.9 4.23-.09 6.9 2.5 6.9 6.9-.09 4.23-2.5 6.9-6.9 6.9Z"/><path d="M12 8.5V12l2 1"/><path d="M12 2v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="M22 12h-2"/><path d="m17.66 17.66-1.41-1.41"/><path d="M12 22v-2"/><path d="m6.34 17.66 1.41-1.41"/><path d="M2 12h2"/><path d="m4.93 6.34 1.41-1.41"/></svg>
                    <span id="quiz-title-text">Quiz Reflexivo</span>
                </h2>
                <div id="quiz-container" class="max-w-2xl mx-auto">
                    <!-- Quiz content will be generated by JS -->
                </div>
            </div>

            <!-- Slide 5: Conclusión -->
            <div class="slide">
                 <div class="flex flex-col items-center justify-center h-full text-center">
                    <div class="bg-green-500 text-white p-4 rounded-full w-24 h-24 flex items-center justify-center mb-8 shadow-lg">
                       <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M14.5 9.5 11 13l-2-2"/></svg>
                    </div>
                    <h2 id="s5-title" class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">El Viaje del Autoconocimiento</h2>
                    <p id="s5-p1" class="text-lg text-gray-700 max-w-3xl mx-auto">Cultivar el autoconocimiento no es un destino, sino un viaje continuo. Cada paso te acerca a una vida más auténtica, consciente y plena. ¡Empieza hoy a explorarte!</p>
                 </div>
            </div>
        </div>

        <img src="Gemini_Generated_Image_ud11y2ud11y2ud11.png" alt="Ilustración sobre el autoconocimiento" class="absolute bottom-24 left-1/2 -translate-x-1/2 w-56 md:w-64 h-auto opacity-95 pointer-events-none">

        <!-- Navegación -->
        <div class="absolute bottom-6 right-6 flex space-x-3">
            <button id="prevBtn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full transition duration-300 shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
                Anterior
            </button>
            <button id="nextBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
                Siguiente
            </button>
        </div>
        
        <div id="slide-indicator" class="absolute bottom-8 left-6 text-sm text-gray-500"></div>
    </div>
    
    <div id="progress-bar-container">
        <div id="progress-bar"></div>
    </div>

    <script>
        // --- General Slide Navigation ---
        const slides = document.querySelectorAll('.slide');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const contentScroll = document.querySelector('#presentation-container .content-scroll');
        const quizTitleTextEl = document.getElementById('quiz-title-text');
        // Text elements for i18n
        const langHeadingEl = document.getElementById('lang-heading');
        const langLabelEl = document.getElementById('lang-label');
        const langHelperEl = document.getElementById('lang-helper');
        const moduleLabelEl = document.getElementById('module-label');
        const mainTitleEl = document.getElementById('main-title');
        const mainSubtitleEl = document.getElementById('main-subtitle');
        const s2TitleEl = document.getElementById('s2-title');
        const s2p1El = document.getElementById('s2-p1');
        const s2p2El = document.getElementById('s2-p2');
        const s2p3El = document.getElementById('s2-p3');
        const s3TitleEl = document.getElementById('s3-title');
        const s5TitleEl = document.getElementById('s5-title');
        const s5p1El = document.getElementById('s5-p1');
        const slideIndicator = document.getElementById('slide-indicator');
        const progressBar = document.getElementById('progress-bar');
        let currentSlide = 0;
        const QUIZ_SLIDE_INDEX = 4; // 0-based index for the quiz slide after adding language slide

        // --- Language / Idioma ---
        let lang = localStorage.getItem('lang') || 'es';
        // URL param overrides localStorage (e.g., ?lang=en or ?lang=es)
        try {
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            if (urlLang && (urlLang === 'en' || urlLang === 'es')) {
                lang = urlLang;
                localStorage.setItem('lang', lang);
            }
        } catch (_) {}
        const i18n = {
            es: {
                // Global
                navPrev: 'Anterior',
                navNext: 'Siguiente',
                navRestart: 'Reiniciar',
                stepIndicator: (i, t) => `Paso ${i} de ${t}`,
                // Language slide
                langHeading: 'Idioma',
                langLabel: 'Selecciona tu idioma',
                langHelper: 'Usa el botón Siguiente para continuar',
                // Title slide
                moduleLabel: 'Módulo 1',
                mainTitle: 'Cómo Cultivar tu Autoconocimiento',
                mainSubtitle: 'Para una Vida Plena',
                // Slide 2
                s2Title: '¿Qué es el Autoconocimiento?',
                s2p1: 'Es el conocimiento que tenemos de nosotros mismos, es decir, al conjunto de cosas que sabemos acerca de quiénes somos.',
                s2p2: 'Es un proceso de introspección que nos permite identificar nuestras emociones, fortalezas, debilidades, valores y metas.',
                s2p3: 'Saber quién eres te da las herramientas para tomar mejores decisiones, gestionar tus emociones y construir relaciones más sanas.',
                // Slide 3
                s3Title: 'Fases del Proceso (Haz clic para girar)',
                // Slide 5
                s5Title: 'El Viaje del Autoconocimiento',
                s5p1: 'Cultivar el autoconocimiento no es un destino, sino un viaje continuo. Cada paso te acerca a una vida más auténtica, consciente y plena. ¡Empieza hoy a explorarte!',
                // Quiz
                quizTitle: 'Quiz Reflexivo',
                nextButton: 'Siguiente',
                feedbackCorrect: '¡Correcto!',
                feedbackReflective: '¡Excelente reflexión!',
                feedbackIncorrectPrefix: 'La respuesta correcta era:',
                resultsTitle: 'Quiz Completado',
                resultsScore: (s, t) => `Has acertado ${s} de ${t} preguntas.`,
                resultsNote: 'Recuerda que el objetivo principal es la reflexión. ¡Sigue explorando tu mundo interior!',
                restartQuiz: 'Intentar de nuevo',
            },
            en: {
                // Global (British English)
                navPrev: 'Previous',
                navNext: 'Next',
                navRestart: 'Restart',
                stepIndicator: (i, t) => `Step ${i} of ${t}`,
                // Language slide
                langHeading: 'Language',
                langLabel: 'Select your language',
                langHelper: 'Use the Next button to continue',
                // Title slide
                moduleLabel: 'Module 1',
                mainTitle: 'How to Cultivate Self‑Knowledge',
                mainSubtitle: 'For a Fulfilling Life',
                // Slide 2
                s2Title: 'What is Self‑Knowledge?',
                s2p1: 'It is the knowledge we have of ourselves — what we know about who we are.',
                s2p2: 'It is a process of introspection that helps us identify our emotions, strengths, weaknesses, values and goals.',
                s2p3: 'Knowing who you are gives you the tools to make better decisions, manage your emotions and build healthier relationships.',
                // Slide 3
                s3Title: 'Process Phases (Click to flip)',
                // Slide 5
                s5Title: 'The Journey of Self‑Knowledge',
                s5p1: 'Cultivating self‑knowledge is not a destination but an ongoing journey. Each step brings you closer to a more authentic, conscious and fulfilling life. Start exploring today!',
                // Quiz
                quizTitle: 'Reflective Quiz',
                nextButton: 'Next',
                feedbackCorrect: 'Correct!',
                feedbackReflective: 'Excellent reflection!',
                feedbackIncorrectPrefix: 'The correct answer was:',
                resultsTitle: 'Quiz Completed',
                resultsScore: (s, t) => `You answered ${s} out of ${t} correctly.`,
                resultsNote: 'Remember: the main goal is reflection. Keep exploring your inner world!',
                restartQuiz: 'Try again',
            }
        };

        function applyLanguage() {
            // Static text updates
            if (langHeadingEl) langHeadingEl.textContent = i18n[lang].langHeading;
            if (langLabelEl) langLabelEl.textContent = i18n[lang].langLabel;
            if (langHelperEl) langHelperEl.textContent = i18n[lang].langHelper;

            if (moduleLabelEl) moduleLabelEl.textContent = i18n[lang].moduleLabel;
            if (mainTitleEl) mainTitleEl.textContent = i18n[lang].mainTitle;
            if (mainSubtitleEl) mainSubtitleEl.textContent = i18n[lang].mainSubtitle;

            if (s2TitleEl) s2TitleEl.childNodes[2].nodeValue = ' ' + i18n[lang].s2Title + '\n                ';
            if (s2p1El) s2p1El.textContent = i18n[lang].s2p1;
            if (s2p2El) s2p2El.innerHTML = i18n[lang].s2p2.replace('emociones', '<strong class="text-indigo-500">emociones</strong>')
                                                  .replace('emotions', '<strong class="text-indigo-500">emotions</strong>');
            if (s2p3El) s2p3El.textContent = i18n[lang].s2p3;

            if (s3TitleEl) s3TitleEl.childNodes[2].nodeValue = ' ' + i18n[lang].s3Title + '\n                ';
            if (s5TitleEl) s5TitleEl.textContent = i18n[lang].s5Title;
            if (s5p1El) s5p1El.textContent = i18n[lang].s5p1;

            if (quizTitleTextEl) quizTitleTextEl.textContent = i18n[lang].quizTitle;

            // Rebuild language-dependent components
            createFlipCards();
            if (currentSlide === QUIZ_SLIDE_INDEX) {
                loadQuiz();
            }

            // Update nav labels immediately
            updateNavigation();
        }

        function showSlide(n) {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === n) {
                    slide.classList.add('active');
                }
            });
            // If entering the quiz slide, build quiz with current language
            if (n === QUIZ_SLIDE_INDEX) {
                try { loadQuiz(); } catch (_) {}
            }
            updateNavigation();
        }

        function updateNavigation() {
            prevBtn.disabled = currentSlide === 0;
            if (currentSlide === slides.length - 1) {
                nextBtn.textContent = i18n[lang].navRestart;
            } else {
                nextBtn.textContent = i18n[lang].navNext;
            }
            // Update previous button label
            prevBtn.textContent = i18n[lang].navPrev;

            // Step indicator
            slideIndicator.textContent = i18n[lang].stepIndicator(currentSlide + 1, slides.length);
            const progressPercentage = ((currentSlide + 1) / slides.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;

            // Disable main Next button during quiz until completion
            if (currentSlide === QUIZ_SLIDE_INDEX && !quizCompleted) {
                nextBtn.disabled = true;
            } else {
                nextBtn.disabled = false;
            }
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                showSlide(currentSlide);
            }
        }

        function restartPresentation() {
            currentSlide = 0;
            showSlide(currentSlide);
            // Reset quiz to initial state
            try { loadQuiz(); } catch (_) {}
            // Scroll contenido al inicio
            try { contentScroll && contentScroll.scrollTo({ top: 0, behavior: 'smooth' }); } catch (_) {}
        }

        function handleNextButtonClick() {
            if (currentSlide === slides.length - 1) {
                // En última diapositiva: reiniciar
                restartPresentation();
            } else {
                nextSlide();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        }

        nextBtn.addEventListener('click', handleNextButtonClick);
        prevBtn.addEventListener('click', prevSlide);
        
        // --- Flip Card Logic (Slide 3) ---
        const cardDataByLang = {
            es: [
                { title: 'Autopercepción', color: 'blue', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>`, text: 'Capacidad de percibirnos a nosotros mismos como individuos con un conjunto de cualidades y características diferenciadoras.' },
                { title: 'Autoobservación', color: 'green', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>`, text: 'Implica el reconocimiento de nosotros mismos; de nuestras conductas, nuestras actitudes y las circunstancias que nos rodean.' },
                { title: 'Memoria Autobiográfica', color: 'yellow', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2Z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7Z"/></svg>`, text: 'Es la construcción de nuestra propia historia personal.' },
                { title: 'Autoestima', color: 'red', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>`, text: 'Se refiere a la valoración que hacemos de nosotros mismos.' },
                { title: 'Automotivación', color: 'purple', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m5 12 7-7 7 7"/><path d="m5 19 7-7 7 7"/></svg>`, text: 'Es la habilidad de dirigir nuestro estado emocional hacia la consecución de nuestras metas.' }
            ],
            en: [
                { title: 'Self‑perception', color: 'blue', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>`, text: 'The ability to perceive ourselves as individuals with a set of distinctive qualities and characteristics.' },
                { title: 'Self‑observation', color: 'green', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>`, text: 'Involves recognising ourselves — our behaviours, our attitudes and the circumstances around us.' },
                { title: 'Autobiographical Memory', color: 'yellow', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2Z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7Z"/></svg>`, text: 'It is the construction of our own personal story.' },
                { title: 'Self‑esteem', color: 'red', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>`, text: 'Refers to the evaluation we make of ourselves.' },
                { title: 'Self‑motivation', color: 'purple', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m5 12 7-7 7 7"/><path d="m5 19 7-7 7 7"/></svg>`, text: 'The ability to direct our emotional state towards achieving our goals.' }
            ]
        };

        function createFlipCards() {
            const container = document.querySelector('#presentation-container .slide:nth-child(4) .grid');
            if (!container) return;
            container.innerHTML = '';
            const cards = cardDataByLang[lang];
            cards.forEach(data => {
                const cardHTML = `
                    <div class="card-flip">
                        <div class="card-flip-inner">
                            <div class="card-front bg-${data.color}-500 text-white">
                                <div class="mb-2">${data.icon}</div>
                                <h3 class="font-bold text-lg">${data.title}</h3>
                            </div>
                            <div class="card-back bg-gray-100 text-gray-700">
                                <p>${data.text}</p>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += cardHTML;
            });

            document.querySelectorAll('.card-flip').forEach(card => {
                card.addEventListener('click', () => {
                    card.querySelector('.card-flip-inner').classList.toggle('is-flipped');
                });
            });
        }
        
        // --- Quiz Logic (Slide 4) ---
        const quizDataByLang = {
            es: [
            {
                question: "La capacidad de percibirnos como individuos con cualidades únicas se llama:",
                options: ["Autoestima", "Autopercepción", "Automotivación"],
                answer: "Autopercepción"
            },
            {
                question: "Reflexiona: ¿Qué actividad te ayuda más a 'auto-observarte' en tu día a día?",
                options: ["Escribir un diario", "Meditar", "Hablar con un amigo", "Todas las anteriores"],
                answer: "Todas las anteriores",
                isReflective: true
            },
            {
                question: "La valoración, generalmente positiva, que hacemos de nosotros mismos se conoce como:",
                options: ["Autoestima", "Memoria", "Autoobservación"],
                answer: "Autoestima"
            }
            ],
            en: [
            {
                question: "The ability to perceive ourselves as individuals with unique qualities is called:",
                options: ["Self-esteem", "Self-perception", "Self-motivation"],
                answer: "Self-perception"
            },
            {
                question: "Reflect: Which activity helps you most to 'self-observe' in your daily life?",
                options: ["Keeping a journal", "Meditation", "Talking with a friend", "All of the above"],
                answer: "All of the above",
                isReflective: true
            },
            {
                question: "The generally positive evaluation we make of ourselves is known as:",
                options: ["Self-esteem", "Memory", "Self-observation"],
                answer: "Self-esteem"
            }
            ]
        };

        let quizData = quizDataByLang[lang];

        let currentQuestionIndex = 0;
        let score = 0;
        let quizCompleted = false;
        const quizContainer = document.getElementById('quiz-container');

        function loadQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            quizCompleted = false;
            // If on quiz slide, ensure main Next is disabled
            if (currentSlide === QUIZ_SLIDE_INDEX) updateNavigation();
            quizData = quizDataByLang[lang];
            showQuestion();
        }

        function showQuestion() {
            const questionData = quizData[currentQuestionIndex];
            quizContainer.innerHTML = `
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-lg font-semibold mb-4">${currentQuestionIndex + 1}. ${questionData.question}</p>
                    <div class="space-y-3" id="quiz-options">
                        ${questionData.options.map(option => `
                            <button class="quiz-option w-full text-left p-3 bg-white border-2 border-gray-200 rounded-lg">${option}</button>
                        `).join('')}
                    </div>
                    <div id="quiz-feedback" class="mt-4 text-sm"></div>
                    <button id="next-quiz-btn" class="mt-4 bg-indigo-500 text-white py-2 px-4 rounded-md hidden">${i18n[lang].nextButton}</button>
                </div>
            `;

            document.querySelectorAll('.quiz-option').forEach(button => {
                button.addEventListener('click', selectAnswer);
            });
        }
        
        function selectAnswer(e) {
            const selectedButton = e.target;
            const answer = selectedButton.textContent;
            const questionData = quizData[currentQuestionIndex];
            const options = document.querySelectorAll('.quiz-option');
            const feedbackEl = document.getElementById('quiz-feedback');
            
            options.forEach(btn => btn.disabled = true); // Disable all options

            if (answer === questionData.answer) {
                score++;
                selectedButton.classList.add('correct');
                feedbackEl.innerHTML = `<p class="text-green-600 font-semibold">${questionData.isReflective ? i18n[lang].feedbackReflective : i18n[lang].feedbackCorrect}</p>`;
            } else {
                selectedButton.classList.add('incorrect');
                feedbackEl.innerHTML = `<p class="text-red-600 font-semibold">${i18n[lang].feedbackIncorrectPrefix} <strong>${questionData.answer}</strong></p>`;
                options.forEach(btn => {
                    if (btn.textContent === questionData.answer) {
                        btn.classList.add('correct');
                    }
                });
            }
            
            document.getElementById('next-quiz-btn').classList.remove('hidden');
            document.getElementById('next-quiz-btn').addEventListener('click', () => {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizData.length) {
                    showQuestion();
                } else {
                    showResults();
                }
            });
        }

        function showResults() {
             quizContainer.innerHTML = `
                <div class="bg-indigo-50 p-8 rounded-lg text-center">
                    <h3 class="text-2xl font-bold text-indigo-800 mb-4">${i18n[lang].resultsTitle}</h3>
                    <p class="text-lg mb-4">${i18n[lang].resultsScore(score, quizData.length)}</p>
                    <p class="mb-6">${i18n[lang].resultsNote}</p>
                    <button id="restart-quiz-btn" class="bg-indigo-600 text-white py-2 px-5 rounded-md">${i18n[lang].restartQuiz}</button>
                </div>
            `;
            quizCompleted = true;
            updateNavigation();
            document.getElementById('restart-quiz-btn').addEventListener('click', () => {
                quizCompleted = false;
                updateNavigation();
                loadQuiz();
            });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Language selector
            const languageSelectEl = document.getElementById('language-select');
            if (languageSelectEl) {
                languageSelectEl.value = lang;
                languageSelectEl.addEventListener('change', (e) => {
                    lang = e.target.value;
                    localStorage.setItem('lang', lang);
                    // Reflect language in URL without reloading
                    try {
                        const params = new URLSearchParams(window.location.search);
                        params.set('lang', lang);
                        const newUrl = `${location.pathname}?${params.toString()}${location.hash}`;
                        history.replaceState(null, '', newUrl);
                    } catch (_) {}
                    applyLanguage();
                });
            }

            createFlipCards();
            applyLanguage();
            showSlide(currentSlide);
        });
    </script>
</body>
</html>
